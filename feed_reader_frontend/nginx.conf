# This Nginx configuration is tailored for single-page applications (SPAs).
# It serves static files and ensures that all non-file requests are routed to index.html,
# which is essential for client-side routing (e.g., React Router, Vue Router).

server {
    # Listen on port 80 for incoming HTTP requests.
    listen 80;

    # Set the root directory for serving static files.
    # This should match where your built frontend assets are copied inside the container.
    root /usr/share/nginx/html;

    # Define the default file to serve when a directory is requested.
    index index.html index.htm;

    # Main location block for handling requests.
    location / {
        # Try to serve the requested file directly.
        # If the file is not found, try to serve it with a trailing slash (for directories).
        # If still not found, internally redirect to /index.html.
        # This is crucial for SPAs to handle client-side routing correctly.
        try_files $uri $uri/ /index.html;
    }

    # Optional: Cache control for static assets (e.g., CSS, JS, images).
    # This helps with performance by instructing browsers to cache these files.
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
        expires 30d; # Cache these files for 30 days
        add_header Cache-Control "public, no-transform";
    }

    # Optional: Error page configuration.
    error_page 500 502 503 504 /50x.html;
    location = /50x.html {
        root /usr/share/nginx/html;
    }
}

